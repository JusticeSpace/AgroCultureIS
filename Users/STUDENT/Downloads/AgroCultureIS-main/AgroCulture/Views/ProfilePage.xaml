<UserControl x:Class="AgroCulture.Views.ProfilePage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             Background="Transparent">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="24" MaxWidth="1200">

            <!-- ═══════════════════════════════════════════════════════════ -->
            <!-- КАРТОЧКА 1: ОСНОВНАЯ ИНФОРМАЦИЯ -->
            <!-- ═══════════════════════════════════════════════════════════ -->
            <materialDesign:Card Margin="0,0,0,16" UniformCornerRadius="8"
                                materialDesign:ElevationAssist.Elevation="Dp4">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- HEADER -->
                    <Border Grid.Row="0" CornerRadius="8,8,0,0" Padding="24,16">
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0,0.5" EndPoint="1,0.5">
                                <GradientStop Color="#15803D" Offset="0"/>
                                <GradientStop Color="#16A34A" Offset="1"/>
                            </LinearGradientBrush>
                        </Border.Background>

                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="Account" Width="20" Height="20" 
                                                    Foreground="White" VerticalAlignment="Center"/>
                            <TextBlock Text="Профиль пользователя" FontSize="18" FontWeight="Medium"
                                      Foreground="White" Margin="8,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <!-- CONTENT -->
                    <StackPanel Grid.Row="1" Margin="24">
                        <!-- АВАТАР И РОЛЬ -->
                        <Grid Margin="0,0,0,24">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="24"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Аватар -->
                            <Border Grid.Column="0" Width="96" Height="96" CornerRadius="48">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                        <GradientStop Color="#16A34A" Offset="0"/>
                                        <GradientStop Color="#15803D" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                                <Border.Effect>
                                    <DropShadowEffect BlurRadius="10" ShadowDepth="3" Opacity="0.3"/>
                                </Border.Effect>

                                <TextBlock x:Name="TxtAvatarInitial" Text="П" FontSize="36" 
                                          Foreground="White" FontWeight="Medium"
                                          HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>

                            <!-- Информация справа -->
                            <StackPanel Grid.Column="2" VerticalAlignment="Center">
                                <TextBlock x:Name="TxtUserFullName" Text="Петров Петр Петрович" 
                                          FontSize="20" FontWeight="Medium" Foreground="#1F2937" Margin="0,0,0,8"/>

                                <!-- Badge роли -->
                                <Border x:Name="BorderRoleBadge" CornerRadius="12" Padding="12,6"
                                       HorizontalAlignment="Left" Margin="0,0,0,8"
                                       BorderThickness="1">
                                    <StackPanel Orientation="Horizontal">
                                        <materialDesign:PackIcon x:Name="IconRole" Kind="Shield" 
                                                                Width="12" Height="12" VerticalAlignment="Center"/>
                                        <TextBlock x:Name="TxtRoleName" Text="Администратор" 
                                                  FontSize="12" FontWeight="Medium" Margin="4,0,0,0" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Border>

                                <!-- Описание роли -->
                                <TextBlock x:Name="TxtRoleDescription"
                                          Text="Полный доступ к системе: управление сотрудниками, бронирования, статистика"
                                          FontSize="12" Foreground="#6B7280" TextWrapping="Wrap"
                                          MaxWidth="400" HorizontalAlignment="Left"/>
                            </StackPanel>
                        </Grid>

                        <!-- РАЗДЕЛИТЕЛЬ -->
                        <Border Height="1" Background="#E5E7EB" Margin="0,0,0,24"/>

                        <!-- ПОЛЯ ИНФОРМАЦИИ -->
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="16"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- СТРОКА 1: Логин и Роль -->
                            <Grid Grid.Row="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="16"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- Логин -->
                                <StackPanel Grid.Column="0">
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                        <materialDesign:PackIcon Kind="Account" Width="16" Height="16" 
                                                                Foreground="#6B7280" VerticalAlignment="Center"/>
                                        <TextBlock Text="Логин" FontSize="14" Foreground="#6B7280" Margin="8,0,0,0"/>
                                    </StackPanel>
                                    <TextBox x:Name="TxtUsername" 
                                            Text="admin" 
                                            IsReadOnly="True"
                                            Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                            Background="#F9FAFB" 
                                            Height="56"
                                            Padding="12,0"
                                            VerticalContentAlignment="Center"
                                            FontSize="14"/>
                                </StackPanel>

                                <!-- Роль -->
                                <StackPanel Grid.Column="2">
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                        <materialDesign:PackIcon Kind="Shield" Width="16" Height="16" 
                                                                Foreground="#6B7280" VerticalAlignment="Center"/>
                                        <TextBlock Text="Роль" FontSize="14" Foreground="#6B7280" Margin="8,0,0,0"/>
                                    </StackPanel>
                                    <TextBox x:Name="TxtRoleDisplay" 
                                            Text="Администратор" 
                                            IsReadOnly="True"
                                            Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                            Background="#F9FAFB" 
                                            Height="56"
                                            Padding="12,0"
                                            VerticalContentAlignment="Center"
                                            FontSize="14"/>
                                </StackPanel>
                            </Grid>

                            <!-- СТРОКА 2: Телефон и Email -->
                            <Grid Grid.Row="2">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="16"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- Телефон -->
                                <StackPanel Grid.Column="0">
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                        <materialDesign:PackIcon Kind="Phone" Width="16" Height="16" 
                                                                Foreground="#6B7280" VerticalAlignment="Center"/>
                                        <TextBlock Text="Телефон" FontSize="14" Foreground="#6B7280" Margin="8,0,0,0"/>
                                    </StackPanel>
                                    <TextBox x:Name="TxtPhone" 
                                            IsReadOnly="True"
                                            Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                            Background="#F9FAFB" 
                                            Height="56"
                                            Padding="12,0"
                                            VerticalContentAlignment="Center"
                                            FontSize="14"/>
                                </StackPanel>

                                <!-- Email -->
                                <StackPanel Grid.Column="2">
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                        <materialDesign:PackIcon Kind="Email" Width="16" Height="16" 
                                                                Foreground="#6B7280" VerticalAlignment="Center"/>
                                        <TextBlock Text="Email" FontSize="14" Foreground="#6B7280" Margin="8,0,0,0"/>
                                    </StackPanel>
                                    <TextBox x:Name="TxtEmail" 
                                            IsReadOnly="True"
                                            Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                            Background="#F9FAFB" 
                                            Height="56"
                                            Padding="12,0"
                                            VerticalContentAlignment="Center"
                                            FontSize="14"/>
                                </StackPanel>
                            </Grid>
                        </Grid>

                        <!-- РАЗДЕЛИТЕЛЬ -->
                        <Border Height="1" Background="#E5E7EB" Margin="0,24,0,24"/>

                        <!-- ФИО с редактированием -->
                        <StackPanel Margin="0,0,0,16">
                            <Grid Margin="0,0,0,8">
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                                    <materialDesign:PackIcon Kind="AccountCircle" Width="16" Height="16" 
                                                            Foreground="#6B7280" VerticalAlignment="Center"/>
                                    <TextBlock Text="ФИО" FontSize="14" Foreground="#6B7280" Margin="8,0,0,0"/>
                                </StackPanel>

                                <Button x:Name="BtnEditProfile" HorizontalAlignment="Right"
                                       Style="{StaticResource MaterialDesignFlatButton}"
                                       Click="BtnEditProfile_Click">
                                    <StackPanel Orientation="Horizontal">
                                        <materialDesign:PackIcon Kind="Pencil" Width="16" Height="16"
                                                                Foreground="#15803D" VerticalAlignment="Center"/>
                                        <TextBlock Text="Редактировать" FontSize="12" Foreground="#15803D" Margin="4,0,0,0"/>
                                    </StackPanel>
                                </Button>
                            </Grid>

                            <!-- Режим просмотра -->
                            <TextBox x:Name="TxtFullNameView" 
                                    Text="Петров Петр Петрович"
                                    Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                    IsReadOnly="True" 
                                    Background="#F9FAFB" 
                                    Height="56"
                                    Padding="12,0"
                                    VerticalContentAlignment="Center"
                                    FontSize="14"
                                    Visibility="Visible"/>

                            <!-- Режим редактирования -->
                            <StackPanel x:Name="PanelEditFullName" Visibility="Collapsed">
                                <TextBox x:Name="TxtFullNameEdit"
                                        Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                        materialDesign:HintAssist.Hint="Введите ФИО"
                                        Height="56" 
                                        Padding="12,0"
                                        VerticalContentAlignment="Center"
                                        FontSize="14"
                                        Margin="0,0,0,12"/>

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="12"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <Button Grid.Column="0" Click="BtnSaveProfile_Click"
                                           Style="{StaticResource MaterialDesignRaisedButton}"
                                           Background="#15803D" Height="40">
                                        <StackPanel Orientation="Horizontal">
                                            <materialDesign:PackIcon Kind="ContentSave" Width="16" Height="16" Margin="0,0,8,0"/>
                                            <TextBlock Text="Сохранить"/>
                                        </StackPanel>
                                    </Button>

                                    <Button Grid.Column="2" Click="BtnCancelEditProfile_Click"
                                           Style="{StaticResource MaterialDesignOutlinedButton}"
                                           Height="40">
                                        <StackPanel Orientation="Horizontal">
                                            <materialDesign:PackIcon Kind="Close" Width="16" Height="16" Margin="0,0,8,0"/>
                                            <TextBlock Text="Отмена"/>
                                        </StackPanel>
                                    </Button>
                                </Grid>
                            </StackPanel>
                        </StackPanel>

                        <!-- РАЗДЕЛИТЕЛЬ -->
                        <Border Height="1" Background="#E5E7EB" Margin="0,8,0,24"/>

                        <!-- Дата регистрации -->
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                <materialDesign:PackIcon Kind="CalendarClock" Width="16" Height="16" 
                                                        Foreground="#6B7280" VerticalAlignment="Center"/>
                                <TextBlock Text="Дата регистрации" FontSize="14" Foreground="#6B7280" Margin="8,0,0,0"/>
                            </StackPanel>
                            <TextBox x:Name="TxtCreatedAt" 
                                    IsReadOnly="True"
                                    Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                    Background="#F9FAFB" 
                                    Height="56"
                                    Padding="12,0"
                                    VerticalContentAlignment="Center"
                                    FontSize="14"/>
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </materialDesign:Card>

            <!-- ═══════════════════════════════════════════════════════════ -->
            <!-- КАРТОЧКА 2: БЕЗОПАСНОСТЬ -->
            <!-- ═══════════════════════════════════════════════════════════ -->
            <materialDesign:Card Margin="0,0,0,16" Padding="24" UniformCornerRadius="8"
                                materialDesign:ElevationAssist.Elevation="Dp4">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                        <materialDesign:PackIcon Kind="Lock" Width="20" Height="20" 
                                                Foreground="#1F2937" VerticalAlignment="Center"/>
                        <TextBlock Text="Безопасность" FontSize="18" FontWeight="Medium"
                                  Foreground="#1F2937" Margin="8,0,0,0"/>
                    </StackPanel>

                    <Button x:Name="BtnChangePassword" Click="BtnChangePassword_Click"
                           Style="{StaticResource MaterialDesignOutlinedButton}"
                           BorderBrush="#22C55E" Height="40" Visibility="Visible">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="Lock" Width="16" Height="16"
                                                    Foreground="#15803D" Margin="0,0,8,0"/>
                            <TextBlock Text="Сменить пароль" Foreground="#15803D"/>
                        </StackPanel>
                    </Button>

                    <!-- Форма смены пароля -->
                    <StackPanel x:Name="PanelPasswordChange" Visibility="Collapsed">
                        <StackPanel Margin="0,0,0,16">
                            <TextBlock Text="Текущий пароль" FontSize="14" Foreground="#374151" Margin="0,0,0,4"/>
                            <PasswordBox x:Name="TxtCurrentPassword" Height="48"
                                        Style="{StaticResource MaterialDesignOutlinedPasswordBox}"/>
                        </StackPanel>

                        <StackPanel Margin="0,0,0,16">
                            <TextBlock Text="Новый пароль" FontSize="14" Foreground="#374151" Margin="0,0,0,4"/>
                            <PasswordBox x:Name="TxtNewPassword" Height="48"
                                        Style="{StaticResource MaterialDesignOutlinedPasswordBox}"/>
                        </StackPanel>

                        <StackPanel Margin="0,0,0,16">
                            <TextBlock Text="Подтвердите новый пароль" FontSize="14" Foreground="#374151" Margin="0,0,0,4"/>
                            <PasswordBox x:Name="TxtConfirmPassword" Height="48"
                                        Style="{StaticResource MaterialDesignOutlinedPasswordBox}"/>
                        </StackPanel>

                        <Grid Margin="0,8,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="12"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Button Grid.Column="0" Click="BtnSavePassword_Click"
                                   Style="{StaticResource MaterialDesignRaisedButton}"
                                   Background="#15803D" Height="40">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="ContentSave" Width="16" Height="16" Margin="0,0,8,0"/>
                                    <TextBlock Text="Изменить пароль"/>
                                </StackPanel>
                            </Button>

                            <Button Grid.Column="2" Click="BtnCancelPassword_Click"
                                   Style="{StaticResource MaterialDesignOutlinedButton}"
                                   Height="40">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="Close" Width="16" Height="16" Margin="0,0,8,0"/>
                                    <TextBlock Text="Отмена"/>
                                </StackPanel>
                            </Button>
                        </Grid>
                    </StackPanel>
                </StackPanel>
            </materialDesign:Card>

            <!-- ═══════════════════════════════════════════════════════════ -->
            <!-- КАРТОЧКА 3: СТАТИСТИКА (АДАПТИВНАЯ) -->
            <!-- ═══════════════════════════════════════════════════════════ -->
            <materialDesign:Card Padding="24" UniformCornerRadius="8"
                                materialDesign:ElevationAssist.Elevation="Dp4">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                        <materialDesign:PackIcon Kind="ChartBar" Width="20" Height="20" 
                                                Foreground="#1F2937" VerticalAlignment="Center"/>
                        <TextBlock Text="Статистика" FontSize="18" FontWeight="Medium"
                                  Foreground="#1F2937" Margin="8,0,0,0"/>
                    </StackPanel>

                    <!-- Grid статистики - динамический -->
                    <Grid x:Name="GridStatistics"/>
                </StackPanel>
            </materialDesign:Card>

        </StackPanel>
    </ScrollViewer>
</UserControl>